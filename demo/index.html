<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="cache-control" content="no-cache" />
    <title>kampos Demos</title>
    <link href="https://fonts.googleapis.com/css?family=Nova+Round&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./lib/codemirror/codemirror.css">
    <link rel="stylesheet" href="lib/codemirror/dracula.css">
    <style>
        body {
            margin: 0;
            background-image: linear-gradient(-45deg, peachpuff, palegreen, plum, peachpuff, palegreen, plum),
            linear-gradient(45deg, purple, darkblue, rebeccapurple, purple, darkblue, rebeccapurple);
            background-blend-mode: screen;
            font-family: "Nova round", cursive, fantasy;
        }

        header {
            text-align: right;
        }

        nav {
            position: fixed;
            width: 256px;
            min-height: 100vh;
            z-index: 10;
            top: 0;
            background-color: #DDA0DDee;
            transform: translateX(-100%);
            transition: transform .5s ease;
        }

        .nav-open nav {
            transform: translateX(0);
        }

        main {
            width: 100vw;
        }

        iframe {
            display: block;
            vertical-align: top;
        }

        iframe {
            width: 100vw;
            height: calc(480 / 854 * 100vw);
            border: none;
            outline: none;
        }

        section {
            position: relative;
            margin: 0 auto 10vh;
        }

        nav ul {
            margin: 1rem 0;
            padding: 0;
            list-style: none;
        }

        nav li {
            padding: 1rem;
        }

        p {
            padding: 1rem;
        }

        button {
            cursor: pointer;
            background: linear-gradient(45deg, beige, plum);
        }

        .code-container {
            position: relative;
        }

        .refresh-button {
            position: absolute;
            top: 1px;
            right: 1px;
            z-index: 10;
            padding: 1em 2em;
            font-size: 16px;
            font-weight: bold;
        }

        header button {
            cursor: pointer;
        }

        #nav-off {
            display: none;
        }

        .nav-open #nav-off {
            display: inline;
        }

        .nav-open #nav-on {
            display: none;
        }

        @media (min-width: 1110px) {
            html, body {
                margin: 0;
            }

            body {
                display: grid;
                grid-template: "nav main" 1fr / 256px calc(100vw - 256px);
            }

            header {
                display: none;
            }

            nav {
                grid-area: nav;
                position: fixed;
                min-height: 100vh;
                background-color: transparent;
                transform: none;
            }

            main {
                grid-area: main;
                width: auto;
            }

            h1 {
                font-size: 128px;
            }

            h2 {
                font-size: 32px;
            }

            section {
                display: flex;
                flex-direction: column;
                width: 854px;
            }

            iframe {
                flex: auto;
                width: 854px;
                height: 480px;
            }

            .CodeMirror {
                flex: auto;
            }

            #code1 + .CodeMirror {
                height: 125rem;
            }

            #code2 + .CodeMirror {
                height: 66rem;
            }

            #code3 + .CodeMirror {
                height: 54rem;
            }
        }
    </style>
</head>
<body>
    <template id="videos1">
        <video id="video1"
               src="./cloudy-night.mp4"
               autoplay
               loop
               muted
               preload="auto"
               crossorigin="anonymous"
               playsinline></video>

        <video id="video2"
               src="./starry-night.mp4"
               autoplay
               loop
               muted
               preload="auto"
               crossorigin="anonymous"
               playsinline></video>
    </template>

    <template id="videos2">
        <video id="video3"
               src="./wheat-field.mp4"
               autoplay
               loop
               muted
               preload="auto"
               crossorigin="anonymous"
               playsinline></video>

        <video id="video4"
               src="./shell-beach.mp4"
               autoplay
               loop
               muted
               preload="auto"
               crossorigin="anonymous"
               playsinline></video>
    </template>

    <template id="videos3">
        <video id="video5"
               src="./man-on-beach.mp4"
               autoplay
               loop
               muted
               preload="auto"
               crossorigin="anonymous"
               playsinline></video>
    </template>
    <nav>
        <ul>
            <li>
                <a href="#displacement-transition">Displacement transition</a>
            </li>
            <li>
                <a href="#fade-hue">Cross-fade with hue-rotation</a>
            </li>
            <li>
                <a href="#turbulence">Fractal noise displacement</a>
            </li>
        </ul>
    </nav>
    <header>
        <button id="nav-on">
            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="arcs"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>
        </button>
        <button id="nav-off">
            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="arcs"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
        </button>
    </header>
    <main>
        <section id="displacement-transition">
            <p>
                Transition between 2 videos with a displacement effect.<br/>
                Hover the video to see it in action.<br/>
                * On mobile tap inside/outside the video.
            </p>
            <iframe id="preview1" srcdoc="" sandbox="allow-scripts allow-same-origin"></iframe>
            <div class="code-container">
                <button class="refresh-button" id="refresh1">Refresh</button>
                <textarea id="code1"></textarea>
            </div>
        </section>
        <section id="fade-hue">
            <p>
                Transition between 2 videos with a cross-fade effect & apply a hue-rotate filter.<br/>
                Move the mouse (tap on mobile) around over the video to see it in action.
            </p>
            <iframe id="preview2" srcdoc="" sandbox="allow-scripts allow-same-origin"></iframe>
            <div class="code-container">
                <button class="refresh-button" id="refresh2">Refresh</button>
                <textarea id="code2"></textarea>
            </div>
        </section>
        <section id="turbulence">
            <p>
                Paint turbulence noise, animate it, and use it as a displacement map for the video.
            </p>
            <iframe id="preview3" srcdoc="" sandbox="allow-scripts allow-same-origin"></iframe>
            <div class="code-container">
                <button class="refresh-button" id="refresh3">Refresh</button>
                <textarea id="code3"></textarea>
            </div>
        </section>
    </main>

    <script src="./lib/codemirror/codemirror.js"></script>
    <script src="./lib/codemirror/javascript.js"></script>
    <script>
        const text1 = document.querySelector('#code1');
        const preview1 = document.querySelector('#preview1');
        const videos1 = document.querySelector('#videos1');
        const refresh1 = document.querySelector('#refresh1');

        fetch('./disp.js')
            .then(resp => resp.text())
            .then(text => {
                text1.value = text;
                const doc = CodeMirror.fromTextArea(text1, {
                    value: text,
                    lineNumbers: true,
                    theme: 'dracula'
                });

                const update = () => updatePreview(preview1, doc.getValue(), videos1.innerHTML);

                refresh1.addEventListener('click', update);

                update();
            });

        const text2 = document.querySelector('#code2');
        const preview2 = document.querySelector('#preview2');
        const videos2 = document.querySelector('#videos2');
        const refresh2 = document.querySelector('#refresh2');

        fetch('./hue-fade.js')
            .then(resp => resp.text())
            .then(text => {
                text2.value = text;
                const doc = CodeMirror.fromTextArea(text2, {
                    value: text,
                    lineNumbers: true,
                    theme: 'dracula'
                });

                const update = () => updatePreview(preview2, doc.getValue(), videos2.innerHTML);

                refresh2.addEventListener('click', update);

                update();
            });

        const text3 = document.querySelector('#code3');
        const preview3 = document.querySelector('#preview3');
        const videos3 = document.querySelector('#videos3');
        const refresh3 = document.querySelector('#refresh3');

        fetch('./turbulence.js')
            .then(resp => resp.text())
            .then(text => {
                text3.value = text;
                const doc = CodeMirror.fromTextArea(text3, {
                    value: text,
                    lineNumbers: true,
                    theme: 'dracula'
                });

                const update = () => updatePreview(preview3, doc.getValue(), videos3.innerHTML);

                refresh3.addEventListener('click', update);

                update();
            });
    </script>
    <script src="index.js"></script>
</body>
</html>
